$(".seminar-info").tooltip({title:"Edit Seminar Information"});$(".seminar-duplicate").tooltip({title:"Duplicate Seminar"});function close_window(){if(confirm("Close Window?")){close()}}var unsaved=false;$(":input").keyup(function(){unsaved=true;$(":button").on("click",function(){unsaved=false})});$("select").change(function(){unsaved=true;$(":button").on("click",function(){unsaved=false})});function unloadPage(){if(unsaved){return"You have unsaved changes on this page. Do you want to leave this page and discard your changes or stay on this page?"}}window.onbeforeunload=unloadPage;var info=$("#status-info");switch($("#status").data("status")){case"Planning":info.addClass("text-warning");break;case"Active":info.addClass("text-success");break;case"Inactive":info.addClass("text-error");break;case"Complete":info.addClass("text-info");break}var group=$("div.control-group"),input=$('div.control-group input[type="text"]'),error=$("div.error"),buttonGroup=$("#update_campaign, #insert_campaign_add_seminar, #update_seminar_info, #insert_seminar_add_seminar, #update_seminar_results, #insert_results_add_seminar"),form=$("#form"),overlay=$(".overlay");group.removeClass("error");input.each(function(a){$(this).blur(function(){if(this.id=="email"){var b=/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;if(b.test(this.value)&&$.trim(this.value)!==""){$("#"+this.name).removeClass("error")}else{$("#"+this.name).addClass("error")}}if(this.id=="date"){if($.trim(this.value)!=="Not Set"||$.trim(this.value)!==""){$("#"+this.name).removeClass("error")}else{$("#"+this.name).addClass("error")}}else{if($.trim(this.value)!==""){$("#"+this.name).removeClass("error")}else{$("#"+this.name).addClass("error")}}})});buttonGroup.on("click",function(a){a.preventDefault();checkForm(this.form,this.name)});function checkForm(e,b){data=new FormData();for(var a=0;a<e.elements.length;a++){if(e.elements[a].type!="submit"){data.append((e.elements[a].name),(e.elements[a].value));if(e.elements[a].type){if(e.elements[a].name=="email"){var d=/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;if(!d.test(e.elements[a].value)||$.trim(e.elements[a].value)===""){$("#"+e.elements[a].name).addClass("error")}else{$("#"+e.elements[a].name).removeClass("error")}}if(e.elements[a].name=="date"){if($.trim(e.elements[a].value)==="Not Set"||$.trim(e.elements[a].value)===""){$("#"+e.elements[a].name).addClass("error")}else{$("#"+e.elements[a].name).removeClass("error")}}else{if($.trim(e.elements[a].value)===""&&e.elements[a].type==="text"){$("#"+e.elements[a].name).addClass("error");if($(e.elements[a]).data("required")===true){var c=$(e.elements[a]).parents(".tab-pane").attr("id");$('#seminar-tabs a[href="#'+c+'"]').tab("show");if($("#missing").length==0){$(".tab-content").prepend('<p id="missing" class="text-error"><strong>PLEASE FILL IN THE HIGHLIGHTED FIELDS</strong></p>')}}}}}else{$("#"+e.elements[a].name).removeClass("error")}}}if(group.hasClass("error")===false){switch(b){case"update_campaign":overlay.height($(document).height()).fadeIn(300);ajaxCampaign(false);break;case"insert_campaign_add_seminar":overlay.height($(document).height()).fadeIn(300);ajaxCampaign();break;case"update_seminar_info":overlay.height($(document).height()).fadeIn(300);ajaxSeminar(false);break;case"insert_seminar_add_seminar":overlay.height($(document).height()).fadeIn(300);ajaxSeminar();break}}else{return false}return false}function ajaxCampaign(a){$.ajax({url:"/campaign/save",type:"POST",data:data,processData:false,contentType:false,success:function(c){console.log(c);var b=$.parseJSON(c);console.log(b);overlay.fadeOut(300);if(a===false){modal="";modal+='<div id="updateCampaign" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="updateCampaignLabel" aria-hidden="true">';modal+='<div class="modal-header">';modal+='<button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>';modal+='<h2 id="updateCampaignLabel">Campaign: '+b.name+"</h2>";modal+="</div>";modal+='<div class="modal-body">';modal+="<p><strong>Success: </strong> You have updated the current record!</p>";modal+="</div>";modal+='<div class="modal-footer">';modal+='<button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>';modal+="</div>";modal+="</div>";$(modal).appendTo("body");$("#updateCampaign").modal().on("hide",function(){location.reload()})}else{window.location.replace(window.location.protocol+"//"+window.location.host+"/seminar?campaign_id="+b.campaign_id)}}})}function ajaxSeminar(a){$.ajax({url:"/seminar/save",type:"POST",data:data,processData:false,contentType:false,success:function(c){console.log(c);var b=$.parseJSON(c);console.log(b);overlay.fadeOut(300);if(a===false){modal="";modal+='<div id="updateSeminar" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="updateSeminarLabel" aria-hidden="true">';modal+='<div class="modal-header">';modal+='<button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>';modal+='<h2 id="updateSeminarLabel">Seminar Updated</h2>';modal+="</div>";modal+='<div class="modal-body">';modal+="<p><strong>Success: </strong> You have updated the current seminar "+b.name+"</p>";modal+="</div>";modal+='<div class="modal-footer">';modal+='<button class="btn" onClick="document.location.reload(true)">Close</button>';modal+="</div>";modal+="</div>";$(modal).appendTo("body");$("#updateSeminar").modal().on("hide",function(){location.reload()})}else{window.location.replace(window.location.protocol+"//"+window.location.host+"/seminar?campaign_id="+b.campaign_id)}}})}$.each($("input"),function(){if($(this).data("input")=="currency"){$(this).maskMoney({symbol:"$ ",allowZero:true})}else{if($(this).data("input")=="number"){$(this).maskMoney({symbol:"",precision:0,allowZero:true})}}});